# A股市K线图工具

一个基于PyQt5的A股K线图显示和分析工具，支持数据导入、选股分析、区间划分等功能。

## 功能特性

- **K线图显示**：使用Lightweight Charts显示A股K线图
- **数据导入**：支持从Excel/CSV文件导入历史数据到SQLite数据库
- **异步加载**：后台加载股票列表和K线数据，提升大数据库的启动速度
- **选股分析**：基于量价关系的选股策略
- **区间划分**：自动识别上涨、震荡区间并在图表上标注
- **搜索过滤**：支持按股票代码或名称搜索
- **缓存优化**：缓存股票列表以加速启动

## 系统要求

- Python 3.8+
- Windows/Linux/macOS

## 依赖包

- PyQt5
- pandas
- sqlite3 (Python内置)
- requests (可选，用于获取实时数据)
- akshare (可选，用于获取A股数据)
- volume_price_selector (自定义模块，用于选股分析)

## 安装步骤

1. 克隆或下载项目文件到本地目录

2. 安装Python依赖：
   ```bash
   pip install PyQt5 pandas requests akshare
   ```

3. 安装自定义模块（如果需要）：
   - 将 `volume_price_selector` 模块放在项目目录中
   - 将 `import_excel_to_sqlite` 模块放在项目目录中

## 运行方法

从项目根目录运行：
```bash
python main.py
```

## 使用说明

1. **启动应用**：运行 `main.py` 启动主界面

2. **选择数据库**：
   - 点击"数据" -> "选择数据库文件" 选择或创建SQLite数据库
   - 或在工具栏中点击数据库路径标签

3. **导入数据**：
   - 点击"数据" -> "选择数据目录" 选择包含Excel/CSV文件的目录
   - 点击"导入"按钮，选择"导入（追加）"或"导入（重建）"

4. **查看K线图**：
   - 选择股票下拉框中的股票
   - 图表会自动加载并显示

5. **选股分析**：
   - 点击"选股" -> "量价突破回踩（当前股票）" 分析当前股票
   - 点击"选股" -> "量价突破回踩（全库扫描）" 扫描所有股票

6. **区间划分**：
   - 点击"选股" -> "划分上涨/震荡区间" 在图表上标注区间

7. **搜索股票**：
   - 在搜索框中输入股票代码或名称进行过滤

## 项目结构

```
pyqt/
├── main.py                 # 主启动文件
├── main_ui.py             # 主界面模块
├── workers.py             # 后台工作线程
├── render_utils.py        # 图表渲染工具
├── tradingview_template.html  # 前端图表模板
└── README.md              # 项目说明
```

## 注意事项

- 首次运行可能需要下载一些依赖数据
- 大型数据库（>1GB）可能需要较长时间加载，应用已优化为异步加载
- 选股功能需要 `volume_price_selector` 模块
- 数据导入需要 `import_excel_to_sqlite` 模块

## 许可证

本项目仅供学习和个人使用，请遵守相关法律法规。

## 贡献

欢迎提交Issue和Pull Request来改进项目。